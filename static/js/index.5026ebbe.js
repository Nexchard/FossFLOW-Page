(()=>{"use strict";var e={3664:function(e,t,o){var r,a=o(5893),i=o(7294),n=o(745);o(4510),o(793),o(102),o(5123),o(9560),o(9734),o(696),o(9929),o(6301),o(6330),o(8221),o(5863);var s=o(6126),l=o(5047),d=o(4241),c=o.n(d),u=o(3017),f=o.n(u),g=o(6211),p=o.n(g),h=o(9614),m=o.n(h),x=o(9636),v=o.n(x);o(2394),o(5646),o(9774);let b=e=>{let{onClose:t}=e,[o,r]=(0,i.useState)({used:0,diagrams:0,otherData:0});(0,i.useEffect)(()=>{n()},[]);let n=()=>{let e=0,t=0,o=0;for(let r in localStorage){let a=localStorage.getItem(r);if(a){let i=new Blob([a]).size;e+=i,r.startsWith("fossflow-")?t+=i:o+=i}}r({used:e,diagrams:t,otherData:o})},s=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB"][t]},l=o.used/5242880*100;return(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:(0,a.jsxs)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"8px",maxWidth:"500px",width:"90%"},children:[(0,a.jsx)("h2",{style:{marginTop:0},children:"Storage Manager"}),(0,a.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,a.jsx)("h3",{children:"Storage Usage"}),(0,a.jsx)("div",{style:{backgroundColor:"#e0e0e0",borderRadius:"4px",height:"20px",overflow:"hidden",marginBottom:"10px"},children:(0,a.jsx)("div",{style:{backgroundColor:l>80?"#f44336":l>60?"#ff9800":"#4caf50",height:"100%",width:`${Math.min(l,100)}%`,transition:"width 0.3s"}})}),(0,a.jsxs)("p",{children:["Used: ",s(o.used)," / ~5 MB (",l.toFixed(1),"%)"]}),(0,a.jsxs)("ul",{style:{fontSize:"14px"},children:[(0,a.jsxs)("li",{children:["FossFLOW diagrams: ",s(o.diagrams)]}),(0,a.jsxs)("li",{children:["Other data: ",s(o.otherData)]})]})]}),(0,a.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,a.jsx)("h3",{children:"Actions"}),(0,a.jsx)("button",{onClick:()=>{let e=localStorage.getItem("fossflow-diagrams");if(e){let t=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`fossflow-backup-${Date.now()}.json`,r.click(),URL.revokeObjectURL(o)}},style:{padding:"10px 20px",marginRight:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Export All Diagrams"}),(0,a.jsx)("button",{onClick:()=>{if(window.confirm("This will remove all saved diagrams. Are you sure?")){let e=[];for(let t in localStorage)t.startsWith("fossflow-")&&e.push(t);e.forEach(e=>localStorage.removeItem(e)),n(),alert("All diagrams cleared. Please reload the page."),window.location.reload()}},style:{padding:"10px 20px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Clear All Diagrams"})]}),(0,a.jsxs)("div",{style:{backgroundColor:"#f8f9fa",padding:"15px",borderRadius:"4px",marginBottom:"20px",fontSize:"14px"},children:[(0,a.jsx)("strong",{children:"Tips to save space:"}),(0,a.jsxs)("ul",{style:{marginBottom:0},children:[(0,a.jsx)("li",{children:"Export diagrams you don't need immediately"}),(0,a.jsx)("li",{children:"Delete old versions of diagrams"}),(0,a.jsx)("li",{children:"Clear browser cache if needed"})]})]}),(0,a.jsx)("button",{onClick:t,style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",width:"100%"},children:"Close"})]})})},w=(0,l.flattenCollections)([c(),f(),m(),p(),v()]),j=!!("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function y(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{let o=e.installing;null!=o&&(o.onstatechange=()=>{"installed"===o.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}n.createRoot(document.getElementById("root")).render((0,a.jsx)(i.StrictMode,{children:(0,a.jsx)(function(){let[e,t]=(0,i.useState)([]),[o,r]=(0,i.useState)(null),[n,l]=(0,i.useState)(""),[d,c]=(0,i.useState)(!1),[u,f]=(0,i.useState)(!1),[g,p]=(0,i.useState)(!1),[h,m]=(0,i.useState)(!1),[x,v]=(0,i.useState)(""),j=(0,i.useRef)(null),[y,S]=(0,i.useState)(0),[k,C]=(0,i.useState)(null),[O,E]=(0,i.useState)(!1),[D,N]=(0,i.useState)(null),[I,T]=(0,i.useState)(!1),L=[{id:"blue",value:"#0066cc"},{id:"green",value:"#00aa00"},{id:"red",value:"#cc0000"},{id:"orange",value:"#ff9900"},{id:"purple",value:"#9900cc"},{id:"black",value:"#000000"},{id:"gray",value:"#666666"}],[R,F]=(0,i.useState)({title:"Untitled Diagram",icons:w,colors:L,items:[],views:[],fitToScreen:!0});(0,i.useEffect)(()=>{let e=localStorage.getItem("fossflow-diagrams");e&&t(JSON.parse(e));let o=localStorage.getItem("fossflow-last-opened"),a=localStorage.getItem("fossflow-last-opened-data");if(o&&a)try{let t={...JSON.parse(a),icons:w};if(F(t),C(t),e){let t=JSON.parse(e).find(e=>e.id===o);t&&(r(t),l(t.name))}}catch(e){console.error("Failed to restore last diagram:",e)}},[]),(0,i.useEffect)(()=>{try{let t=e.map(e=>({...e,data:{...e.data,icons:[]}}));localStorage.setItem("fossflow-diagrams",JSON.stringify(t))}catch(e){console.error("Failed to save diagrams:",e),e instanceof DOMException&&"QuotaExceededError"===e.name&&alert("Storage quota exceeded. Please export important diagrams and clear some space.")}},[e]);let A=()=>{if(!n.trim())return void alert("Please enter a diagram name");let a={title:n,icons:[],colors:k?.colors||R.colors||[],items:k?.items||R.items||[],views:k?.views||R.views||[],fitToScreen:!0},i={id:o?.id||Date.now().toString(),name:n,data:a,createdAt:o?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()};o?t(e.map(e=>e.id===o.id?i:e)):t([...e,i]),r(i),c(!1),E(!1),N(new Date);try{localStorage.setItem("fossflow-last-opened",i.id),localStorage.setItem("fossflow-last-opened-data",JSON.stringify(i.data))}catch(e){console.error("Failed to save diagram:",e),e instanceof DOMException&&"QuotaExceededError"===e.name&&(alert("Storage full! Opening Storage Manager..."),T(!0))}};return(0,i.useEffect)(()=>{if(!k||!O||!o)return;let e=setTimeout(()=>{let e={title:n||o.name,icons:[],colors:k.colors||[],items:k.items||[],views:k.views||[],fitToScreen:!0},r={...o,data:e,updatedAt:new Date().toISOString()};t(e=>e.map(e=>e.id===o.id?r:e));try{localStorage.setItem("fossflow-last-opened-data",JSON.stringify(e)),N(new Date),E(!1)}catch(e){console.error("Auto-save failed:",e),e instanceof DOMException&&"QuotaExceededError"===e.name&&(alert("Storage full! Please use Storage Manager to free up space."),T(!0))}},5e3);return()=>clearTimeout(e)},[k,O,o,n,w]),(0,i.useEffect)(()=>{let e=e=>{if(O)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?",e.returnValue};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[O]),(0,a.jsxs)("div",{className:"App",children:[(0,a.jsxs)("div",{className:"toolbar",children:[(0,a.jsx)("button",{onClick:()=>{let e=O?"You have unsaved changes. Export your diagram first to save it. Continue?":"Create a new diagram?";if(window.confirm(e)){let e={title:"Untitled Diagram",icons:w,colors:L,items:[],views:[],fitToScreen:!0};r(null),l(""),F(e),C(e),S(e=>e+1),E(!1),localStorage.removeItem("fossflow-last-opened"),localStorage.removeItem("fossflow-last-opened-data")}},children:"New Diagram"}),(0,a.jsx)("button",{onClick:()=>c(!0),children:"Save (Session Only)"}),(0,a.jsx)("button",{onClick:()=>f(!0),children:"Load (Session Only)"}),(0,a.jsx)("button",{onClick:()=>p(!0),style:{backgroundColor:"#28a745"},children:"\uD83D\uDCC2 Import File"}),(0,a.jsx)("button",{onClick:()=>m(!0),style:{backgroundColor:"#007bff"},children:"\uD83D\uDCBE Export File"}),(0,a.jsx)("button",{onClick:()=>{o&&O&&A()},disabled:!o||!O,style:{backgroundColor:o&&O?"#ffc107":"#6c757d",opacity:o&&O?1:.5,cursor:o&&O?"pointer":"not-allowed"},title:"Save to current session only",children:"Quick Save (Session)"}),(0,a.jsxs)("span",{className:"current-diagram",children:[o?`Current: ${o.name}`:n||"Untitled Diagram",O&&(0,a.jsx)("span",{style:{color:"#ff9800",marginLeft:"10px"},children:"• Modified"}),(0,a.jsx)("span",{style:{fontSize:"12px",color:"#666",marginLeft:"10px"},children:"(Session storage only - export to save permanently)"})]})]}),(0,a.jsx)("div",{className:"fossflow-container",children:(0,a.jsx)(s.Isoflow,{initialData:R,onModelUpdated:e=>{C(t=>{let o={...t||R,...e,title:e.title||t?.title||R.title||n||"Untitled",icons:w,colors:e.colors||t?.colors||R.colors||[],items:void 0!==e.items?e.items:t?.items||R.items||[],views:void 0!==e.views?e.views:t?.views||R.views||[],fitToScreen:!0};return E(!0),o})},editorMode:"EDITABLE"},y)}),d&&(0,a.jsx)("div",{className:"dialog-overlay",children:(0,a.jsxs)("div",{className:"dialog",children:[(0,a.jsx)("h2",{children:"Save Diagram (Current Session Only)"}),(0,a.jsxs)("div",{style:{backgroundColor:"#fff3cd",border:"1px solid #ffeeba",padding:"15px",borderRadius:"4px",marginBottom:"20px"},children:[(0,a.jsx)("strong",{children:"⚠️ Important:"})," This save is temporary and will be lost when you close the browser.",(0,a.jsx)("br",{}),"Use ",(0,a.jsx)("strong",{children:"Export File"})," to permanently save your work."]}),(0,a.jsx)("input",{type:"text",placeholder:"Enter diagram name",value:n,onChange:e=>l(e.target.value),onKeyDown:e=>"Enter"===e.key&&A(),autoFocus:!0}),(0,a.jsxs)("div",{className:"dialog-buttons",children:[(0,a.jsx)("button",{onClick:A,children:"Save"}),(0,a.jsx)("button",{onClick:()=>c(!1),children:"Cancel"})]})]})}),u&&(0,a.jsx)("div",{className:"dialog-overlay",children:(0,a.jsxs)("div",{className:"dialog",children:[(0,a.jsx)("h2",{children:"Load Diagram (Current Session Only)"}),(0,a.jsxs)("div",{style:{backgroundColor:"#fff3cd",border:"1px solid #ffeeba",padding:"15px",borderRadius:"4px",marginBottom:"20px"},children:[(0,a.jsx)("strong",{children:"⚠️ Note:"})," These saves are temporary. Export your diagrams to keep them permanently."]}),(0,a.jsx)("div",{className:"diagram-list",children:0===e.length?(0,a.jsx)("p",{children:"No saved diagrams found in this session"}):e.map(i=>(0,a.jsxs)("div",{className:"diagram-item",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:i.name}),(0,a.jsx)("br",{}),(0,a.jsxs)("small",{children:["Updated: ",new Date(i.updatedAt).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"diagram-actions",children:[(0,a.jsx)("button",{onClick:()=>(e=>{if(O&&!window.confirm("You have unsaved changes. Continue loading?"))return;let t={...e.data,icons:w};r(e),l(e.name),F(t),C(t),S(e=>e+1),f(!1),E(!1);try{localStorage.setItem("fossflow-last-opened",e.id),localStorage.setItem("fossflow-last-opened-data",JSON.stringify(e.data))}catch(e){console.error("Failed to save last opened:",e)}})(i),children:"Load"}),(0,a.jsx)("button",{onClick:()=>{var a;return a=i.id,void(window.confirm("Are you sure you want to delete this diagram?")&&(t(e.filter(e=>e.id!==a)),o?.id===a&&(r(null),l(""))))},children:"Delete"})]})]},i.id))}),(0,a.jsx)("div",{className:"dialog-buttons",children:(0,a.jsx)("button",{onClick:()=>f(!1),children:"Close"})})]})}),(0,a.jsx)("input",{ref:j,type:"file",accept:".json",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let o=new FileReader;o.onload=e=>{try{let t=e.target?.result,o=JSON.parse(t),r={...o,title:o.title||"Imported Diagram",icons:w,colors:o.colors?.length?o.colors:L,fitToScreen:!1!==o.fitToScreen};F(r),l(o.title||"Imported Diagram"),C(r),S(e=>e+1),p(!1),E(!0),j.current&&(j.current.value=""),setTimeout(()=>{alert(`Diagram "${o.title||"Untitled"}" imported successfully!`)},100)}catch(e){alert("Invalid JSON file. Please check the file format.")}},o.onerror=()=>{alert("Error reading file. Please try again.")},o.readAsText(t)},style:{display:"none"}}),g&&(0,a.jsx)("div",{className:"dialog-overlay",children:(0,a.jsxs)("div",{className:"dialog",children:[(0,a.jsx)("h2",{children:"Import Diagram"}),(0,a.jsxs)("div",{style:{border:"2px dashed #ccc",borderRadius:"8px",padding:"40px",textAlign:"center",marginBottom:"20px",backgroundColor:"#f8f9fa"},children:[(0,a.jsx)("p",{style:{fontSize:"18px",marginBottom:"20px"},children:"Choose a JSON file to import"}),(0,a.jsx)("button",{onClick:()=>{j.current?.click()},style:{padding:"12px 24px",fontSize:"16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Select File"}),(0,a.jsx)("p",{style:{marginTop:"20px",color:"#666",fontSize:"14px"},children:"Supported format: .json files exported from Isoflow"})]}),(0,a.jsx)("div",{className:"dialog-buttons",children:(0,a.jsx)("button",{onClick:()=>p(!1),children:"Cancel"})})]})}),h&&(0,a.jsx)("div",{className:"dialog-overlay",children:(0,a.jsxs)("div",{className:"dialog",children:[(0,a.jsx)("h2",{children:"Export Diagram"}),(0,a.jsxs)("div",{style:{backgroundColor:"#d4edda",border:"1px solid #c3e6cb",padding:"15px",borderRadius:"8px",marginBottom:"20px"},children:[(0,a.jsxs)("p",{style:{margin:"0 0 10px 0"},children:[(0,a.jsx)("strong",{children:"✅ Recommended:"})," This is the best way to save your work permanently."]}),(0,a.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#155724"},children:"Exported JSON files can be imported later or shared with others."})]}),(0,a.jsxs)("div",{className:"dialog-buttons",children:[(0,a.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify({title:n||k?.title||R.title||"Exported Diagram",icons:w,colors:k?.colors||R.colors||[],items:k?.items||R.items||[],views:k?.views||R.views||[],fitToScreen:!0},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download=`${n||"diagram"}-${new Date().toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(t),m(!1),E(!1)},children:"Download JSON"}),(0,a.jsx)("button",{onClick:()=>m(!1),children:"Cancel"})]})]})}),I&&(0,a.jsx)(b,{onClose:()=>T(!1)})]})},{})})),r={onSuccess:()=>console.log("Service worker registered successfully"),onUpdate:()=>console.log("Service worker update available")},"serviceWorker"in navigator&&new URL("https://nexchard.github.io/FossFLOW-Page",window.location.href).origin===window.location.origin&&window.addEventListener("load",()=>{var e,t;let o="https://nexchard.github.io/FossFLOW-Page/service-worker.js";j?(e=o,t=r,fetch(e,{headers:{"Service-Worker":"script"}}).then(o=>{let r=o.headers.get("content-type");404===o.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):y(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")}),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker.")})):y(o,r)})}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,o),i.exports}o.m=e,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;o.t=function(r,a){if(1&a&&(r=this(r)),8&a||"object"==typeof r&&r&&(4&a&&r.__esModule||16&a&&"function"==typeof r.then))return r;var i=Object.create(null);o.r(i);var n={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>{n[e]=()=>r[e]});return n.default=()=>r,o.d(i,n),i}})(),o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce((t,r)=>(o.f[r](e,t),t),[])),o.u=e=>"static/js/async/"+e+".3c541c6a.js",o.miniCssF=e=>""+e+".css",o.h=()=>"8596c27659dcc6ee",o.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="fossflow-local:";o.l=function(r,a,i,n){if(e[r])return void e[r].push(a);if(void 0!==i)for(var s,l,d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var f=function(t,o){s.onerror=s.onload=null,clearTimeout(g);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(function(e){return e(o)}),t)return t(o)},g=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),l&&document.head.appendChild(s)}})(),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=[];o.O=(t,r,a,i)=>{if(r){i=i||0;for(var n=e.length;n>0&&e[n-1][2]>i;n--)e[n]=e[n-1];e[n]=[r,a,i];return}for(var s=1/0,n=0;n<e.length;n++){for(var r=e[n][0],a=e[n][1],i=e[n][2],l=!0,d=0;d<r.length;d++)(!1&i||s>=i)&&Object.keys(o.O).every(e=>o.O[e](r[d]))?r.splice(d--,1):(l=!1,i<s&&(s=i));if(l){e.splice(n--,1);var c=a();void 0!==c&&(t=c)}}return t}})(),o.p="https://nexchard.github.io/FossFLOW-Page/",(()=>{var e={980:0};o.f.j=function(t,r){var a=o.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((o,r)=>a=e[t]=[o,r]);r.push(a[2]=i);var n=o.p+o.u(t),s=Error();o.l(n,function(r){if(o.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",s.name="ChunkLoadError",s.type=i,s.request=n,a[1](s)}},"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,r)=>{var a,i,n=r[0],s=r[1],l=r[2],d=0;if(n.some(t=>0!==e[t])){for(a in s)o.o(s,a)&&(o.m[a]=s[a]);if(l)var c=l(o)}for(t&&t(r);d<n.length;d++)i=n[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(c)},r=self.webpackChunkfossflow_local=self.webpackChunkfossflow_local||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=o.O(void 0,["126","361","746"],function(){return o(3664)});r=o.O(r)})();